geom_boxplot()
#single mean model
ioct = ioct %>%
mutate(single.mean = mean(IOCT_Time)) %>%
mutate(single_mean_resid = IOCT_Time - single.mean)
#standard error
ioct %>%
summarize(single.mean.se = sd(single_mean_resid))
ioct = ioct %>%
group_by(CS) %>%
mutate(cs.mean = mean(IOCT_Time)) %>%
mutate(cs_mean_resid = IOCT_Time - cs.mean)
ioct %>%
count(CS, sex)
ioct %>%
count(CS, sex) %>%
group_by(CS) %>%
mutate(perc = n/n())
mutate(perc = n/sum(n)
ioct %>%
ioct %>%
count(CS, sex) %>%
group_by(CS) %>%
mutate(perc = n/sum(n))
library(tidyverse)
ioct <- read_csv(file = "https://raw.githubusercontent.com/kfcaby/MA376AY21/master/data/IOCT_Data_Cleaned.csv")
View(ioct)
ioct %>%
ggplot(aes(y = IOCT_Time)) +
geom_boxplot()
# Do corps squad athletes do better on the IOCT?
ioct <- ioct %>%
filter(IOCT_Time < 400)
ioct %>%
ggplot(aes(y = IOCT_Time)) +
geom_boxplot()
ioct %>%
ggplot(aes(x = CS, y = IOCT_Time)) +
geom_boxplot()
ioct %>%
ggplot(aes(x = factor(CS), y = IOCT_Time)) +
geom_boxplot()
ioct %>%
ggplot(aes(x = factor(CS), y = IOCT_Time, color = sex)) +
geom_boxplot()
ioct %>%
ggplot(aes(color = factor(CS), y = IOCT_Time, x = sex)) +
geom_boxplot()
#single-mean model
ioct %>%
summarise(meanIOCT = mean(IOCT_Time))
# add a column of residuals
ioct = ioct %>%
mutate(single_mean = mean(IOCT_Time))
View(ioct)
# add a column of residuals
ioct = ioct %>%
mutate(single_mean = mean(IOCT_Time)) %>%
mutate(single_mean_residual = IOCT_Time - single_mean)
# standard error
ioct %>%
summarize(single_mean_se = sd(single_mean_residual))
## separate means model
ioct %>%
group_by(CS) %>%
summarise(meanIOCT = mean(IOCT_Time))
# add a column of residuals
ioct = ioct %>%
group_by(CS) %>%
mutate(CS_mean = mean(IOCT_Time)) %>%
mutate(CS_mean_residual = IOCT_Time - CS_mean)
# standard error
ioct %>%
summarise(CS_mean_se = sqrt(sum(CS_mean_residual^2)/(378)))
# standard error
ioct %>%
group_by() %>%
summarise(CS_mean_se = sqrt(sum(CS_mean_residual^2)/(378)))
## separate means model
ioct %>%
group_by(CS) %>%
summarise(meanIOCT = mean(IOCT_Time))
library(tidyverse)
ioct <- read_csv(file = "https://raw.githubusercontent.com/kfcaby/MA376AY21/master/data/IOCT_Data_Cleaned.csv")
## separate means model
ioct %>%
group_by(CS) %>%
summarise(meanIOCT = mean(IOCT_Time))
library(tidyverse)
ioct <- read_csv(file = "https://raw.githubusercontent.com/kfcaby/MA376AY21/master/data/IOCT_Data_Cleaned.csv")
ioct %>%
ggplot(aes(y = IOCT_Time)) +
geom_boxplot()
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(y = IOCT_Time)) +
geom_boxplot()
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = factor(CS), y = IOCT_Time)) +
geom_boxplot()
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = factor(CS), y = IOCT_Time)) +
geom_boxplot()
ioct %>%
filter(IOCT_Time < 400) %>%
group_by(CS) %>%
summarize(meanIOCT = mean(IOCT_Time))
#mean IOCT time by Corps Squad
ioct %>%
filter(IOCT_Time < 300) %>%
group_by(CS) %>%
summarize(meanIOCT = mean(IOCT_Time))
#mean IOCT time by Corps Squad
ioct %>%
filter(IOCT_Time < 400) %>%
group_by(CS) %>%
summarize(meanIOCT = mean(IOCT_Time))
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point()
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm")
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme(text = element_text(size = 12))
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme(text = element_text(size = 20))
ioct %>%
filter(IOCT_Time < 400) %>%
filter(height > 60) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme(text = element_text(size = 20))
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme(text = element_text(size = 20))
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme(text = element_text(size = 20)) +
theme_bw()
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw() +
theme(text = element_text(size = 20))
ioct %>%
filter(IOCT_Time < 400) %>%
ggplot(aes(x = height, y = IOCT_Time, color = sex)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw() +
theme(text = element_text(size = 20)) +
labs(x = "height (inches)", y = "IOCT time (seconds)")
library(tidyverse)
wages <- read_csv(file = "wage_data (1).csv")
wages %>%
group_by(Age) %>%
summarise(median = median(Earnings)) %>%
ggplot(aes(x = Age, y = median, color = size)) +
geom_line()
View(wages)
wages %>%
group_by(Age) %>%
summarise(median = median(Earnings)) %>%
ggplot(aes(x = Age, y = median, color = FamilySize)) +
geom_line()
wages %>%
group_by(Age, FamilySize) %>%
summarise(median = median(Earnings)) %>%
ggplot(aes(x = Age, y = median, color = FamilySize)) +
geom_line()
wages %>%
group_by(Age, FamilySize) %>%
summarise(median = median(Earnings)) %>%
ggplot(aes(x = Age, y = median, color = factor(FamilySize))) +
geom_line()
wages %>%
filter(FamilySize < 7) %>%
group_by(Age, FamilySize) %>%
summarise(median = median(Earnings)) %>%
ggplot(aes(x = Age, y = median, color = factor(FamilySize))) +
geom_line()
wages %>%
filter(FamilySize < 7) %>%
group_by(Age, Earnings)
cadets <- c("Tim","Alex","DJ"."Waverly","Furman","Rory",
"Henry", "Paul","William","Andrew","Harrison",
"Meeah", "Angeline", "Sydney",
"Diego", "David", "Anna")
cadets <- c("Tim","Alex","DJ"."Waverly","Furman","Rory",
"Henry", "Paul","William","Andrew","Harrison",
"Meeah", "Angeline", "Sydney","Diego", "David", "Anna")
cadets <- c("Tim","Alex","DJ"."Waverly","Furman","Rory",
"Henry", "Paul","William","Andrew","Harrison",
"Meeah", "Angeline", "Sydney","Diego", "David", "Anna")
cadets <- c("Tim","Alex","DJ","Waverly","Furman","Rory",
"Henry", "Paul","William","Andrew","Harrison",
"Meeah", "Angeline", "Sydney","Diego", "David", "Anna")
group1 <- sample(cadets, size = 9)
group2 <- cadets[!(cadets %in% group1)]
group1
group2
data <- read_csv(file = "data/memorizing letters (Exploration 1.1).csv")
library(tidyverse)
data <- read_csv(file = "data/memorizing letters (Exploration 1.1).csv")
View(data)
cadets <- c("Tim","Alex","DJ","Waverly","Furman","Rory",
"Henry", "Paul","William","Andrew","Harrison",
"Meeah", "Angeline", "Sydney","Diego", "David", "Anna")
group1 <- sample(cadets, size = 9)
group2 <- cadets[!(cadets %in% group1)]
group1
library(tidyverse)
wages <- read_csv(file = "data/wage_data.csv")
View(wages)
wages %>%
filter(Earnings > 0) %>%
filter(Occupation == "52: Armed Forces")
wages %>%
filter(Earnings > 0) %>%
filter(Occupation == "52: Armed Forces") %>%
ggplot(aes(x = Education, y = Earnings)) +
geom_boxplot()
wages %>%
filter(Earnings > 0) %>%
filter(Occupation == "52: Armed Forces") %>%
mutate(Education = factor(Education, levels = c("Less than HS",
"HS Graduate",
"Bachelors",
"Masters",
"PhD/MD/JD",
"Some College/Associates"))) %>%
ggplot(aes(x = Education, y = Earnings)) +
geom_boxplot()
wages %>%
filter(Earnings > 0) %>%
filter(Occupation == "52: Armed Forces") %>%
mutate(Education = factor(Education, levels = c("Less than HS",
"HS Graduate",
"Some College/Associates",
"Bachelors",
"Masters",
"PhD/MD/JD"))) %>%
ggplot(aes(x = Education, y = Earnings)) +
geom_boxplot()
cadets <- c("Tim","Alex","DJ","Waverly","Furman","Rory",
"Henry", "Paul","William","Andrew","Harrison",
"Meeah", "Angeline", "Sydney","Diego", "David", "Anna")
group1 <- sample(cadets, size = 9)
group2 <- cadets[!(cadets %in% group1)]
group1
group2
library(tidyverse)
cadets <- read_csv(file = "https://raw.githubusercontent.com/kfcaby/MA376AY21/master/data/memorizing%20letters%20(Exploration%201.1)")
View(cadets)
cadets %>%
ggplot(aes(y = letters)) +
geom_boxplot()
cadets %>%
ggplot(aes(x = group, y = letters)) +
geom_boxplot()
cadets %>%
ggplot(aes(x = factor(group), y = letters)) +
geom_boxplot()
cadets %>%
group_by(group) %>%
summarize(mean = mean(letters))
# calculate residuals
cadets = cadets %>%
mutate(single.mean = mean(letters))
# calculate residuals
cadets = cadets %>%
mutate(single.mean = mean(letters),
single.mean.residual = letters - single.mean)
cadets %>%
summarize(single.mean.se = sqrt(sum(single.mean.residual^2)/14))
library(tidyverse)
cadets <- read_csv(file = "https://raw.githubusercontent.com/kfcaby/MA376AY21/master/data/memorizing%20letters%20(Exploration%201.1)")
View(cadets)
cadets %>%
ggplot(aes(x = factor(group), y = letters)) +
geom_boxplot()
cadets %>%
group_by(group) %>%
summarize(mean = mean(letters))
cadets = cadets %>%
mutate(single.mean = mean(letters),
single.mean.residual = letters - single.mean)
cadets %>%
summarize(single.mean.se = sqrt(sum(single.mean.residual^2)/14))
# calculate residuals
cadets = cadets %>%
group_by() %>%
mutate(group.mean = mean(letters))
# calculate residuals
cadets = cadets %>%
group_by(group) %>%
mutate(group.mean = mean(letters))
cadets = cadets %>%
mutate(group.mean.residual = letters - group.mean)
#standard error
cadets %>%
summarize(group.mean.se = sqrt(sum(group.mean.residual^2)/13))
#standard error
cadets %>%
group_by() %>%
summarize(group.mean.se = sqrt(sum(group.mean.residual^2)/13))
SST = cadets %>%
summarize(sum(single.mean.residual^2))
SST
SST = cadets %>%
group_by() %>%
summarize(sum(single.mean.residual^2))
SST
SSM = cadets %>%
group_by() %>%
summarize(sum((group.mean - single.mean)^2))
SSM
model_group = cadets %>%
lm(letters ~ group, data = .)
model_group %>% summary()
model_group = cadets %>%
lm(letters ~ factor(group), data = .)
model_group %>% summary()
anova(model_group)
SSM
250*0.3
library(tidyverse)
cadets <- read_csv(file = "https://raw.githubusercontent.com/kfcaby/MA376AY21/master/data/memorizing%20letters%20(Exploration%201.1)")
cadets %>%
ggplot(aes(x = factor(group), y = letters)) +
geom_boxplot()
cadets.sim <- cadets
diffs <- c()
cadets.sim <- cadets.sim %>%
mutate(group.sim = sample(group))
View(cadets.sim)
cadets.sim <- cadets.sim %>%
mutate(group.sim = sample(group)) %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters))
View(cadets.sim)
cadets.sim %>%
mutate(group.sim = sample(group)) %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean))
cadets.sim <- cadets
diffs <- c()
cadets.sim %>%
mutate(group.sim = sample(group)) %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean))
cadets.sim %>%
mutate(group.sim = sample(group)) %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
pull(diff)
results <- cadets.sim %>%
mutate(group.sim = sample(group)) %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
pull(diff)
for(i in 1:5000){
results <- cadets.sim %>%
mutate(group.sim = sample(group)) %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
pull(diff)
diff[i] = results[2]
}
results[2]
for(i in 1:5000){
results <- cadets.sim %>%
mutate(group.sim = sample(group)) %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
pull(diff)
diffs[i] = results[2]
}
hist(diffs)
dev.off()
library(tidyverse)
cadets <- read_csv(file = "https://raw.githubusercontent.com/kfcaby/MA376AY21/master/data/memorizing%20letters%20(Exploration%201.1)")
cadets %>%
ggplot(aes(x = factor(group), y = letters)) +
geom_boxplot()
cadets.sim <- cadets
View(cadets.sim)
cadets.sim <- cadets.sim %>%
mutate(group.sim = sample(group))
#calculate the means
cadets.sim %>%
summarize(group.mean = mean(letters))
#calculate the means
cadets.sim %>%
group_by(group) %>%
summarize(group.mean = mean(letters))
#calculate the means
cadets.sim %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters))
#calculate the means
cadets.sim %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean))
#calculate the means
cadets.sim %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
select(diff)
#calculate the means
diff <- cadets.sim %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
select(diff)
diff[2]
#calculate the means
diff <- cadets.sim %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
pull(diff)
diff
diff[2]
for(i in 1:1000){
#shuffle the groups
cadets.sim <- cadets.sim %>%
mutate(group.sim = sample(group))
#calculate the means
diff <- cadets.sim %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
pull(diff)
diff[2]
}
results <- c()
for(i in 1:1000){
#shuffle the groups
cadets.sim <- cadets.sim %>%
mutate(group.sim = sample(group))
#calculate the means
diff <- cadets.sim %>%
group_by(group.sim) %>%
summarize(group.mean = mean(letters)) %>%
mutate(diff = group.mean - lag(group.mean)) %>%
pull(diff)
results[i] = diff[2]
}
hist(results)
results < -10.167
sum(results < -10.167)
sum(results < -10.167)/1000
cadets %>%
t.test(letters ~ group, data = .)
# regression notation
cadets %>%
lm(letters ~ group, data = .) %>%
summary()
# regression notation
cadets %>%
lm(letters ~ factor(group), data = .) %>%
summary()
#t.test
cadets %>%
t.test(letters ~ group, data = ., var.equal = FALSE)
#t.test
cadets %>%
t.test(letters ~ group, data = ., var.equal = TRUE)
#t.test
cadets %>%
t.test(letters ~ group, data = .)
# regression notation
cadets %>%
lm(letters ~ factor(group), data = .) %>%
summary()

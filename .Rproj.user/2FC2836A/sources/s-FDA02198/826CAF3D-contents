library(tidyverse)

ioct <- read_csv(file = "https://raw.githubusercontent.com/kfcaby/MA376AY21/master/data/IOCT_Data_Cleaned.csv")

#let's look at the response
ioct %>% 
  filter(IOCT_Time < 400) %>% 
  ggplot(aes(y = IOCT_Time)) +
  geom_boxplot()

#let's look at the response by corps squad status
ioct %>% 
  filter(IOCT_Time < 400) %>% 
  ggplot(aes(y = IOCT_Time, 
             color = factor(CS),
             x = sex)) +
  geom_boxplot()

# statistical models

ioct %>% 
  count(CS, sex) %>% 
  group_by(CS) %>% 
  mutate(perc = n/sum(n))

#single mean model
ioct = ioct %>% 
  mutate(single.mean = mean(IOCT_Time)) %>% 
  mutate(single_mean_resid = IOCT_Time - single.mean)

#standard error
ioct %>% 
  summarize(single.mean.se = sd(single_mean_resid))

ioct = ioct %>% 
  group_by(CS) %>% 
  mutate(cs.mean = mean(IOCT_Time)) %>% 
  mutate(cs_mean_resid = IOCT_Time - cs.mean)




